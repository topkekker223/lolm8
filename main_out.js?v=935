(function(window,$){var testCanvas=document.createElement('canvas');if(typeof console=='undefined'||typeof DataView=='undefined'||typeof WebSocket=='undefined'||testCanvas==null||testCanvas.getContext==null||window.localStorage==null){alert("You browser does not support this game, we recommend you to use Firefox to play this");return;}
var hasInitialized=false;var queryString={};(function(){var tmp=window.location.search;if(tmp.charAt(0)=='?')tmp=tmp.slice(1);var arr=tmp.split('&');for(var i=0;i<arr.length;i++){var kv=arr[i].split('=');queryString[kv[0]]=kv[1];}})();window["queryString"]=queryString;var isInFacebook='fb'in queryString;var isInMiniclip='miniclip'in queryString;var hasGamepadSupport="gamepad"in queryString;var doHttpRedirect=function()
{createCookie('agario_redirect','1',1);window.location.href="http:"+ window.location.href.substring(window.location.protocol.length);}
var clearHttpRedirect=function()
{eraseCookie('agario_redirect');}
function createCookie(name,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString();}
else var expires="";document.cookie=name+"="+value+expires+"; path=/";}
function readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);}
return null;}
function eraseCookie(name){createCookie(name,"",-1);}
var isHttps=window.location.protocol!="http:";var gotRedirected=readCookie('agario_redirect')=='1';var goingToRedirect=false;if(!(isInFacebook||isInMiniclip)){if(isHttps&&!gotRedirected){doHttpRedirect();goingToRedirect=true;}else{clearHttpRedirect();}}
if(!isHttps){clearHttpRedirect();}
if(!goingToRedirect){setTimeout(clearHttpRedirect,3000);}
if(window['agarioNoInit'])return;var protocol=window.location.protocol;var isSecure=(protocol=='https:');var MASTER_URL=protocol+"//"+ EnvConfig["master_url"]+"/";var ua=window.navigator.userAgent;if(ua.indexOf("Android")!=-1){if(window['ga']){window['ga']('send','event','MobileRedirect','PlayStore');}
setTimeout(function(){window.location.href="https://play.google.com/store/apps/details?id=com.miniclip.agar.io";},1000);return;}
if(ua.indexOf("iPhone")!=-1||ua.indexOf("iPad")!=-1||ua.indexOf("iPod")!=-1){if(window['ga']){window['ga']('send','event','MobileRedirect','AppStore');}
setTimeout(function(){window.location.href="https://itunes.apple.com/app/agar.io/id995999703?mt=8&at=1l3vajp";},1000);return;}
var agarApp={};window['agarApp']=agarApp;var isMobile=('ontouchstart'in window)&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(window.navigator.userAgent));var splitImg=new Image();splitImg.src="/img/split.png";var givePriorityToGamepad=false;var afterInitInterv;window['agarioInit']=function(){afterInitInterv=setTimeout(window['agarioAfterInit'],100);}
window['agarioAfterInit']=function(){clearInterval(afterInitInterv);hasInitialized=true;MC.wasInitialized();processLocalData();checkFacebookLogin();agarApp.gplus.checkGPlusLogin();MC.getLatestConfigurationID();agarApp.core.init();MC.refreshRegionInfo();setInterval(MC.refreshRegionInfo,3*60*1000);if(/firefox/i.test(navigator.userAgent)){document.addEventListener("DOMMouseScroll",onMouseWheel,false);}else{document.body['onmousewheel']=onMouseWheel;}
if(presetGameMode){MC.setGameMode(presetGameMode,false);}
loadCountryCodes();if(hasPartyToken()){MC.joinParty(getPartyToken());}else{MC.checkRegion();}
window['MC']["setInGameState"](false);}
var acid;var countryCode='';window['setAcid']=function(v){acid=v;}
function hasPartyToken(){return getPartyToken()!="";}
function getPartyToken(){if(window.location.hash&&window.location.hash.length>=6)return window.location.hash;var search=parseQuery(window.location.search);if(search.party&&search.party.length>=6)return search.party;return"";}
function parseQuery(queryUrl){if(queryUrl.startsWith("?"))queryUrl=queryUrl.substr(1);var kvs=queryUrl.split("&");var dict={};for(var i=0;i<kvs.length;i++){var pair=window.decodeURIComponent(kvs[i]).split("=");dict[pair[0]]=pair[1];}
return dict;}
function loadCountryCodes(){$.get(protocol+'//gc.agar.io',function(data){var rdata=data.split(' ');countryCode=rdata[0];var subcountryCode=rdata[1]||"";setCountryCode(countryCode,subcountryCode);},'text')
["fail"](function(){console.warn("gc.arar.io gave an invalid response, using a random region");var total=Object.keys(countries).length;var rnd=Math.floor(Math.random()*total);countryCode=Object.keys(countries)[rnd];setCountryCode(countryCode,"");});}
function setCountryCode(countryCode,subcountryCode){console.log("Country:",countryCode,subcountryCode);var regionChanged=false;if(countries.hasOwnProperty(countryCode)){if(typeof countries[countryCode]=='string'){if(!MC.getRegion()){MC.setRegion(countries[countryCode],!hasPartyToken());$('#region')['val'](MC.getRegion());regionChanged=true;}}else{if(countries[countryCode].hasOwnProperty(subcountryCode)){if(!MC.getRegion()){MC.setRegion(countries[countryCode][subcountryCode],!hasPartyToken());$('#region')['val'](MC.getRegion());regionChanged=true;}}}}
initCookieConsent();if(!regionChanged&&!hasPartyToken())
MC.reconnect();}
function initCookieConsent(){if(countryCode=='')return;cc.initialise({"cookies":{"social":{},"analytics":{},"advertising":{},"necessary":{}},"settings":{"consenttype":"explicit"}});cc.setLocation(countryCode);}
window.showConsoleLogo=function(){try{var logo=" "+'      ,,,,,                                                  ╓▄▓▄               \n'+'     ┌▓▓▓▓▓╖                                                 ╙▓▓▀`              \n'+'     ▓▓▓╜▓▓▓        ,╓▄▄▄▄▄▄▄▄┐  ,╓▄▄▄▄▄╖     ╓▄▄ ,╓▄▄⌐      ╓▄▄▄     ╓▄▄▄▄▄,   \n'+'    ╟▓▓▌ ╙▓▓▓      ▓▓▓▀▀▀▓▓▓▓▀`  ▀▓▀▀▀▀▓▓▓╖   ▓▓▓▓▓▓▓▓`      ]▓▓▓   ▄▓▓▓▓▀▓▓▓▓Ç \n'+'   ▐▓▓▓`  ▓▓▓▌    ]▓▓▓   ]▓▓▓     ,,,,,▓▓▓▓   ▓▓▓▓╜          ]▓▓▓  ╟▓▓▓`   j▓▓▓U\n'+'  ╓▓▓▓▓▓▓▓▓▓▓▓╖    ▀▓▓▓▄▄▓▓▓╜   ▄▓▓▓▓▀▀▓▓▓▓   ▓▓▓▌           ]▓▓▓  ▓▓▓▓    ]▓▓▓▌\n'+'  ▓▓▓▓▀▀▀▀▀▀▓▓▓µ   ╔▓▓▀"""     ]▓▓▓▒  ,▓▓▓▓   ▓▓▓▌     ,╓╓,  ]▓▓▓  ╙▓▓▓╖   ▄▓▓▓`\n'+' ▓▓▓▓       ▓▓▓▓   ╙▓▓▓▓▓▓▓█▓╖  ▓▓▓▓██▓▀▓▓▓   ▓▓▓▌     ▓▓▓▓  ]▓▓▓   ╙▀▓▓▓▓▓▓▓▀  \n'+' ````        ```` ▄▓▓▀""""▀▓▓▓    """`  ```   ````      ╙"`   ```      `"""`    \n'+'                  ▓▓▓▄,,,╓▄▓▓▓                                                  \n'+'                   ╙▀▀▓▓▓▀▀▀                                                    \n';console.log(logo);}catch(e){}}
var keysDown={};function addKeyListeners(){window.onkeydown=function(e){if(keysDown[e.keyCode])return;keysDown[e.keyCode]=true;switch(e.keyCode){case 32:if(window['core']&&window['core']['split'])window['core']['split']();e.preventDefault();break;case 87:if(window['core']&&window['core']['eject'])window['core']['eject']();break;case 81:if(window['core']&&window['core']['specialOn'])window['core']['specialOn']();break;case 27:e.preventDefault();MC.showNickDialog(300);if(window['core']&&window['core']['setFps'])window['core']['setFps'](30);if($('#oferwallContainer').is(':visible')){window['closeOfferwall']();}
if($('#videoContainer').is(':visible')){window['closeVideoContainer']();}
break;case 220:e.preventDefault();MC.showStatsDialog();break;}}
window.onkeyup=function(e){keysDown[e.keyCode]=false;if(e.keyCode==81){if(window['specialOff'])window['core']['specialOff']();}}}
window["addKeyListeners"]=addKeyListeners;function onMouseWheel(e){e.preventDefault();if(window['core']&&window['core']["playerZoom"])window['core']["playerZoom"](e.wheelDelta/-120||e.detail||0);}
var _core=(function(exports){var events={};var _debug=false;var _config={skipDraw:true,predictionModifier:1.1}
exports.init=function(){agarApp.account.init();agarApp.google.loadServices();agarApp.gplus.init();_debug='debug'in window['queryString'];if(_debug){agarApp.debug.showDebug();}}
exports.bind=function(event,handler){$(events).bind(event,handler);}
exports.unbind=function(event,handler){$(events).unbind(event,handler);}
exports.trigger=function(event,params){$(events).trigger(event,params);}
exports.__defineGetter__("debug",function(){return _debug;})
exports.__defineSetter__("debug",function(value){return _debug=value;})
exports.__defineGetter__("proxy",function(){return window['MC'];})
exports.__defineGetter__("config",function(){return _config;})
return exports;})({});agarApp.core=_core;agarApp.cache={}
var _debug=(function(exports){var _initialized=false;var _container;var _showPrediction=false;var _series={};var _charts={};var defaultSeriesStyle={strokeStyle:'rgba(0, 255, 0, 1)',fillStyle:'rgba(0, 255, 0, 0.2)',lineWidth:2};var createTimeseries=function()
{var tseries=new TimeSeries({resetBounds:false});return tseries;}
var createOneChart=function(id,opts)
{_series[id]=createTimeseries();createChart(id,[_series[id]],opts,[{strokeStyle:'rgba(0, 255, 0, 1)',fillStyle:'rgba(0, 255, 0, 0.2)',lineWidth:2}]);}
var createChart=function(id,series,chart_opts,series_opts){var canvasID=id+"Canvas";var chartDiv=$("<canvas>",{id:canvasID});_container.append(chartDiv);var chart=new SmoothieChart(chart_opts);for(var i=0;i<series.length;i++){var serie=series[i];var opts=_.extend(defaultSeriesStyle,series_opts[i]);chart.addTimeSeries(serie,opts);}
chart.streamTo(document.getElementById(canvasID),0);_charts[id]=_charts;}
var init=function(){if(_initialized)return;_container=$('#debug-overlay');createOneChart('networkUpdate',{name:"network updates",minValue:0,maxValue:240});_series['rttSDev']=createTimeseries();_series['rttMean']=createTimeseries();createChart('rttMean',[_series['rttSDev'],_series['rttMean']],{name:"rtt",minValue:0,maxValue:120},[{strokeStyle:'rgba(255, 0, 0, 1)',fillStyle:'rgba(0, 255, 0, 0.2)',lineWidth:2},{strokeStyle:'rgba(0, 255, 0, 1)',fillStyle:'rgba(0, 255, 0, 0)',lineWidth:2}]);createOneChart('fps',{name:"fps",minValue:0,maxValue:70});_initialized=true;};exports.showDebug=function(){init();agarApp.core.debug=true;_container.show();};exports.hideDebug=function(){_container.hide();agarApp.core.debug=false;}
exports.updateChart=function(id,time,value)
{if(!_initialized)return;if(id in _series){_series[id].append(time,value);}}
exports.__defineGetter__("showPrediction",function(){return _showPrediction;})
exports.__defineSetter__("showPrediction",function(value){return _showPrediction=value;})
return exports;})({});agarApp.debug=_debug;var countries={'AF':'JP-Tokyo','AX':'EU-London','AL':'EU-London','DZ':'EU-London','AS':'SG-Singapore','AD':'EU-London','AO':'EU-London','AI':'US-Atlanta','AG':'US-Atlanta','AR':'BR-Brazil','AM':'JP-Tokyo','AW':'US-Atlanta','AU':'SG-Singapore','AT':'EU-London','AZ':'JP-Tokyo','BS':'US-Atlanta','BH':'JP-Tokyo','BD':'JP-Tokyo','BB':'US-Atlanta','BY':'EU-London','BE':'EU-London','BZ':'US-Atlanta','BJ':'EU-London','BM':'US-Atlanta','BT':'JP-Tokyo','BO':'BR-Brazil','BQ':'US-Atlanta','BA':'EU-London','BW':'EU-London','BR':'BR-Brazil','IO':'JP-Tokyo','VG':'US-Atlanta','BN':'JP-Tokyo','BG':'EU-London','BF':'EU-London','BI':'EU-London','KH':'JP-Tokyo','CM':'EU-London','CA':'US-Atlanta','CV':'EU-London','KY':'US-Atlanta','CF':'EU-London','TD':'EU-London','CL':'BR-Brazil','CN':'CN-China','CX':'JP-Tokyo','CC':'JP-Tokyo','CO':'BR-Brazil','KM':'EU-London','CD':'EU-London','CG':'EU-London','CK':'SG-Singapore','CR':'US-Atlanta','CI':'EU-London','HR':'EU-London','CU':'US-Atlanta','CW':'US-Atlanta','CY':'JP-Tokyo','CZ':'EU-London','DK':'EU-London','DJ':'EU-London','DM':'US-Atlanta','DO':'US-Atlanta','EC':'BR-Brazil','EG':'EU-London','SV':'US-Atlanta','GQ':'EU-London','ER':'EU-London','EE':'EU-London','ET':'EU-London','FO':'EU-London','FK':'BR-Brazil','FJ':'SG-Singapore','FI':'EU-London','FR':'EU-London','GF':'BR-Brazil','PF':'SG-Singapore','GA':'EU-London','GM':'EU-London','GE':'JP-Tokyo','DE':'EU-London','GH':'EU-London','GI':'EU-London','GR':'EU-London','GL':'US-Atlanta','GD':'US-Atlanta','GP':'US-Atlanta','GU':'SG-Singapore','GT':'US-Atlanta','GG':'EU-London','GN':'EU-London','GW':'EU-London','GY':'BR-Brazil','HT':'US-Atlanta','VA':'EU-London','HN':'US-Atlanta','HK':'JP-Tokyo','HU':'EU-London','IS':'EU-London','IN':'JP-Tokyo','ID':'JP-Tokyo','IR':'JP-Tokyo','IQ':'JP-Tokyo','IE':'EU-London','IM':'EU-London','IL':'JP-Tokyo','IT':'EU-London','JM':'US-Atlanta','JP':'JP-Tokyo','JE':'EU-London','JO':'JP-Tokyo','KZ':'JP-Tokyo','KE':'EU-London','KI':'SG-Singapore','KP':'JP-Tokyo','KR':'JP-Tokyo','KW':'JP-Tokyo','KG':'JP-Tokyo','LA':'JP-Tokyo','LV':'EU-London','LB':'JP-Tokyo','LS':'EU-London','LR':'EU-London','LY':'EU-London','LI':'EU-London','LT':'EU-London','LU':'EU-London','MO':'JP-Tokyo','MK':'EU-London','MG':'EU-London','MW':'EU-London','MY':'JP-Tokyo','MV':'JP-Tokyo','ML':'EU-London','MT':'EU-London','MH':'SG-Singapore','MQ':'US-Atlanta','MR':'EU-London','MU':'EU-London','YT':'EU-London','MX':'US-Atlanta','FM':'SG-Singapore','MD':'EU-London','MC':'EU-London','MN':'JP-Tokyo','ME':'EU-London','MS':'US-Atlanta','MA':'EU-London','MZ':'EU-London','MM':'JP-Tokyo','NA':'EU-London','NR':'SG-Singapore','NP':'JP-Tokyo','NL':'EU-London','NC':'SG-Singapore','NZ':'SG-Singapore','NI':'US-Atlanta','NE':'EU-London','NG':'EU-London','NU':'SG-Singapore','NF':'SG-Singapore','MP':'SG-Singapore','NO':'EU-London','OM':'JP-Tokyo','PK':'JP-Tokyo','PW':'SG-Singapore','PS':'JP-Tokyo','PA':'US-Atlanta','PG':'SG-Singapore','PY':'BR-Brazil','PE':'BR-Brazil','PH':'JP-Tokyo','PN':'SG-Singapore','PL':'EU-London','PT':'EU-London','PR':'US-Atlanta','QA':'JP-Tokyo','RE':'EU-London','RO':'EU-London','RU':'RU-Russia','RW':'EU-London','BL':'US-Atlanta','SH':'EU-London','KN':'US-Atlanta','LC':'US-Atlanta','MF':'US-Atlanta','PM':'US-Atlanta','VC':'US-Atlanta','WS':'SG-Singapore','SM':'EU-London','ST':'EU-London','SA':'EU-London','SN':'EU-London','RS':'EU-London','SC':'EU-London','SL':'EU-London','SG':'JP-Tokyo','SX':'US-Atlanta','SK':'EU-London','SI':'EU-London','SB':'SG-Singapore','SO':'EU-London','ZA':'EU-London','SS':'EU-London','ES':'EU-London','LK':'JP-Tokyo','SD':'EU-London','SR':'BR-Brazil','SJ':'EU-London','SZ':'EU-London','SE':'EU-London','CH':'EU-London','SY':'EU-London','TW':'JP-Tokyo','TJ':'JP-Tokyo','TZ':'EU-London','TH':'JP-Tokyo','TL':'JP-Tokyo','TG':'EU-London','TK':'SG-Singapore','TO':'SG-Singapore','TT':'US-Atlanta','TN':'EU-London','TR':'TK-Turkey','TM':'JP-Tokyo','TC':'US-Atlanta','TV':'SG-Singapore','UG':'EU-London','UA':'EU-London','AE':'EU-London','GB':'EU-London','US':'US-Atlanta','UM':'SG-Singapore','VI':'US-Atlanta','UY':'BR-Brazil','UZ':'JP-Tokyo','VU':'SG-Singapore','VE':'BR-Brazil','VN':'JP-Tokyo','WF':'SG-Singapore','EH':'EU-London','YE':'JP-Tokyo','ZM':'EU-London','ZW':'EU-London'};var Maths=(function(module){var lerp=function(value,target,t){t=clamp(t,0,1);return(value+ t*(target- value));};var clamp=function(v,min,max){if(v<min)return min;if(v>max)return max;return v;};var fixed=function(value,precision){var n=Math.pow(10,precision);return((~~(value*n))/ n );
}
module.lerp=lerp;module.clamp=clamp;module.fixed=fixed;return module;}({}));window['Maths']=Maths;var Utils=(function(module){var prettyTime=function(){var now=new Date();var date=[now.getMonth()+ 1,now.getDate(),now.getFullYear()];var time=[now.getHours(),now.getMinutes(),now.getSeconds()];for(var i=1;i<3;i++){if(time[i]<10){time[i]="0"+ time[i];}}
return"["+date.join("/")+" "+ time.join(":")+"]";};module.ptime=prettyTime;return module;}({}));window['Utils']=Utils;String.prototype.replaceAll=function(target,newStr){var retStr=this;while(retStr.indexOf(target)!=-1)
{retStr=retStr.replace(target,newStr);}
return retStr;};function isEmpty(val)
{return val==null||val==undefined||val==='';}
function normalizeAngle(ang){while(ang<-Math.PI)ang+=Math.PI*2;while(ang>Math.PI)ang-=Math.PI*2;return ang;}
function RGBtoStyle(c){var str=c.toString(16);while(str.length<6)str="0"+ str;return"#"+ str;}
function clamp(v,min,max){if(v<min)return min;if(v>max)return max;return v;}
function smoothStep(x){x=clamp(x,0.0,1.0);return x;}
function smoothStep2(x){x=clamp(x,0.0,1.0);return x*x*(3- 2*x);}
function shuffle(array){var counter=array.length,temp,index;while(counter>0){index=Math.floor(Math.random()*counter);counter--;temp=array[counter];array[counter]=array[index];array[index]=temp;}
return array;}
if(!Date.now){Date.now=function(){return new Date().getTime();}}//#include "favicon"
var DEFAULT_STORE_OBJECT='storeObjectInfo';var defaultStorage={'context':null,'defaultProvider':'facebook','loginIntent':'0','userInfo':{'socialToken':null,'tokenExpires':'','level':'','xp':'','xpNeeded':'','name':'','picture':'','displayName':'','loggedIn':'0','socialId':''}}
window['defaultSt']=defaultStorage;var authToken=null;var storageInfo=defaultStorage;window["storageInfo"]=storageInfo;window["createDefaultStorage"]=createDefaultStorage;function createDefaultStorage(){storageInfo=defaultStorage;}
function performLogin(context){if(context=='google'){context='google';}else{context='facebook';}
storageInfo["context"]=context;updateStorage();}
window["updateStorage"]=updateStorage;function updateStorage(){var successful=true;try{window.localStorage[DEFAULT_STORE_OBJECT]=JSON.stringify(storageInfo);}catch(error){successful=false;}
if(successful){storageInfo=JSON.parse(window.localStorage[DEFAULT_STORE_OBJECT]);window["storageInfo"]=storageInfo;}
validateContext();}
function validateContext(){if(storageInfo.context=='google'){$('#gPlusShare')['show']();$('#fbShare')['hide']();}else{$('#gPlusShare')['hide']();$('#fbShare')['show']();}}
function setUserData(userInfo){var shouldAnimate=$('#helloContainer')['attr']('data-has-account-data')=='1';if(userInfo['displayName']!=""){userInfo['name']=userInfo['displayName'];}
if(userInfo['name']==null||userInfo['name']==undefined){userInfo['name']="";}
var idx=userInfo['name'].lastIndexOf("_");if(idx!=-1){userInfo['name']=userInfo['name'].substring(0,idx);}
$('#helloContainer')['attr']('data-has-account-data','1');$('#helloContainer')['attr']('data-logged-in','1');$('.agario-profile-panel .progress-bar-star')['text'](userInfo["level"]);$('.agario-exp-bar .progress-bar-text')['text'](userInfo["xp"]+'/'+ userInfo["xpNeeded"]+' XP');$('.agario-exp-bar .progress-bar')['css']('width',(88*userInfo["xp"]/userInfo["xpNeeded"]).toFixed(2)+'%');$('.agario-profile-name')['text'](userInfo['name']);if(userInfo["picture"]!=""){$('.agario-profile-picture')['attr']('src',userInfo["picture"]);}
storageInfo["userInfo"]["level"]=userInfo["level"];storageInfo["userInfo"]["xp"]=userInfo["xp"];storageInfo["userInfo"]["xpNeeded"]=userInfo["xpNeeded"];storageInfo["userInfo"]["displayName"]=userInfo["name"];storageInfo["userInfo"]["loggedIn"]="1";window['updateStorage']();}
window['hasLoginIntent']=function(){return storageInfo['loginIntent']=='1';}
function processLocalData(){if(window.localStorage[DEFAULT_STORE_OBJECT]!=null){storageInfo=JSON.parse(window.localStorage[DEFAULT_STORE_OBJECT]);}
if(storageInfo["loginIntent"]=='1'){performLogin(storageInfo["context"]);}else{window['MC']["setGuest"]();}
if(storageInfo["userInfo"]["name"]!=''||storageInfo["userInfo"]["displayName"]!=''){setUserData(storageInfo["userInfo"]);}}
window['checkLoginStatus']=function(){if(storageInfo["loginIntent"]=='1'){updateLoggedUserInfo();performLogin(storageInfo["context"]);}}
var updateLoggedUserInfo=function()
{window['MC']['setProfilePicture'](storageInfo['userInfo']['picture']);window['MC']['setSocialId'](storageInfo['userInfo']['socialId']);}
window['logout']=function(){var context=storageInfo.context;if(storageInfo.context=='google'){logoutGooglePlus();}
storageInfo=defaultStorage;delete window.localStorage[DEFAULT_STORE_OBJECT];window.localStorage[DEFAULT_STORE_OBJECT]=JSON.stringify(defaultStorage);updateStorage();authToken=null;agarApp.cache['sentGameServerLogin']=false;delete agarApp.cache['login_info'];$('#helloContainer')['attr']('data-logged-in','0');$('#helloContainer')['attr']('data-has-account-data','0');$('.timer').text('');$('#gPlusShare')['hide']();$('#fbShare')['show']();$('#user-id-tag').text('');$('.shop-blocker').fadeOut(100);MC.doLogout();MC.reconnect(true);window['ga']('send','event','Logout',context);}
function setAccountData(obj,shouldAnimate){var hasUserData=$('#helloContainer')['attr']('data-has-account-data','1');storageInfo["userInfo"]["xp"]=obj["xp"];storageInfo["userInfo"]["xpNeeded"]=obj["xpNeeded"];storageInfo["userInfo"]["level"]=obj["level"];updateStorage();if(hasUserData&&shouldAnimate){animateAccountData(obj);}else{$('.agario-profile-panel .progress-bar-star')['text'](obj["level"]);$('.agario-exp-bar .progress-bar-text')['text'](obj["xp"]+'/'+ obj["xpNeeded"]+' XP');$('.agario-exp-bar .progress-bar')['css']('width',(88*obj["xp"]/obj["xpNeeded"]).toFixed(2)+'%');}}
function animateAccountData(opt_obj,opt_fcb){var obj=opt_obj;var isLoggedIn=storageInfo["userInfo"]['loggedIn'];if(!isLoggedIn)return;var shouldAnimate=$('#helloContainer').is(":visible")&&$('#helloContainer')['attr']('data-has-account-data')=='1';if(obj==null||obj==undefined){obj=storageInfo['userInfo'];}
if(shouldAnimate){var initialXP=+$('.agario-exp-bar .progress-bar-text')['first']()['text']().split('/')[0];var initialXPNeeded=+$('.agario-exp-bar .progress-bar-text')['first']()['text']().split('/')[1].split(' ')[0];var initialLevel=$('.agario-profile-panel .progress-bar-star')['first']()['text']();if(initialLevel!=obj["level"]){animateAccountData({"xp":initialXPNeeded,"xpNeeded":initialXPNeeded,"level":initialLevel},function(){$('.agario-profile-panel .progress-bar-star')['text'](obj["level"]);$('.agario-exp-bar .progress-bar')['css']('width','100%');$('.progress-bar-star')['addClass']('animated tada')['one']('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend',function(){$('.progress-bar-star')['removeClass']('animated tada');});setTimeout(function(){$('.agario-exp-bar .progress-bar-text')['text'](obj["xpNeeded"]+'/'+ obj["xpNeeded"]+' XP');animateAccountData({"xp":0,"xpNeeded":obj["xpNeeded"],"level":obj["level"]},function(){animateAccountData(obj);});},1000);});}else{var start=Date.now();var cb=function(){var progress=smoothStep2((Date.now()- start)/ 1000);
$('.agario-exp-bar .progress-bar-text')['text'](~~(initialXP+(obj["xp"]- initialXP)*progress)+'/'+ obj["xpNeeded"]+' XP');$('.agario-exp-bar .progress-bar')['css']('width',(88*(initialXP+(obj["xp"]- initialXP)*progress)/ obj["xpNeeded"]).toFixed(2) + '%');
if(opt_fcb)opt_fcb();if(progress<1.0){window.requestAnimationFrame(cb);}}
window.requestAnimationFrame(cb);}}}
window['animateAccountData']=animateAccountData;window["toggleSocialLogin"]=function(){$('#socialLoginContainer')['toggle']();$('#settings')['hide']();$('#instructions')['hide']();MC.showInstructionsPanel();}
window["toggleSettings"]=function(){$('#settings')['toggle']();$('#socialLoginContainer')['hide']();$('#instructions')['hide']();MC.showInstructionsPanel();}
var _account=(function(exports){var _userInfo=null;var handleUserLogin=function(event,userInfo){window['TRModule']['init'](userInfo.id);if(_userInfo!=null&&_userInfo.id==userInfo.id)return;_userInfo=userInfo;if(window['ssa_json']!=null){window['ssa_json']['applicationUserId']=""+userInfo.id;window['ssa_json']['custom_user_id']=""+userInfo.id;}
if(typeof SSA_CORE!="undefined"){SSA_CORE['start']();}}
var handleUserLogout=function(){}
exports.init=function(){agarApp.core.bind('user_login',handleUserLogin);agarApp.core.bind('user_logout',handleUserLogout);}
exports.setUserData=function(data){setUserData(data);}
exports.setAccountData=function(data,shouldAnimate)
{setAccountData(data,shouldAnimate)}
exports.animateAccountData=function(obj){animateAccountData(obj);}
return exports;})({});agarApp.account=_account;var retryAttempts=0;var fbLoaded=false;var fbInitted=false;var fbScope='public_profile,email,user_friends,user_birthday';var fbAsyncInit=function(){window['FB']['init']({'appId':EnvConfig["fb_app_id"],'cookie':true,'xfbml':true,'status':true,'version':'v2.8'});fbLoaded=true;checkFacebookLogin();if(EnvConfig['env_staging']||EnvConfig['env_production']){(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='https://renotifier.miniclippt.com/rntracking.js?app_id='+EnvConfig['fb_app_id']
s.parentNode.insertBefore(g,s);}(document,'script'));}}
function checkFacebookLogin(){if(fbInitted==true||hasInitialized==false||fbLoaded==false)return;fbInitted=true;if((window["storageInfo"]["loginIntent"]=='1'&&window["storageInfo"]["context"]=='facebook')||isInFacebook){window['FB']['getLoginStatus'](function(response){if(response.status==='connected'){fbLoginCallback(response);}else if(response.status==='not_authorized'){window['logout']();}else{window['logout']();}});}
window['facebookRelogin']=facebookLoginPromise;window['facebookLogin']=facebookLoginPromise;window['facebookReconnect']=facebookReconnect;}
function facebookReconnect(callback){fbInitted=false;window['logout']();window['facebookRelogin'](callback);}
window['facebookLogin']=function(callback){alert("Facebook Login is unavailable, please try again later or check if you are using private mode.");callback(null);};function facebookLoginPromise(callback){if(window['FB']==null){alert("You seem to have something blocking Facebook on your browser, please check for any extensions");callback(null);}
else{storageInfo["loginIntent"]='1';window["updateStorage"]();window['FB']['login'](function(response){fbLoginCallback(response);callback(response);},{scope:fbScope,'auth_type':'rerequest'});return true;}}
function fbLoginCallback(response){if(response.status!='connected')return;var fbtoken=response['authResponse']['accessToken'];if(fbtoken==null||fbtoken=="undefined"||fbtoken==""){if(retryAttempts<3)
{retryAttempts++;window['facebookRelogin']();}
window['logout']();}
else
{window['fetchFacebookPermissions']();window["MC"]["doLoginWithFB"](response['authResponse']);agarApp.cache['login_info']=[fbtoken,'facebook'];window['FB']['api']("/me/picture?width=180&height=180",function(pictureResponse){storageInfo["userInfo"]["picture"]=pictureResponse.data.url;window["updateStorage"]();$('.agario-profile-picture')['attr']('src',pictureResponse.data.url);storageInfo['userInfo']['socialId']=response['authResponse']['userID'];updateLoggedUserInfo();});$('#helloContainer')['attr']('data-logged-in','1');storageInfo["context"]='facebook';storageInfo["loginIntent"]='1';window["updateStorage"]();window['MC']['showInstructionsPanel'](true);fbSendAnalyticsEvent();}}
function fbSendAnalyticsEvent()
{window['FB']['api']("/me/?fields=id,gender,birthday,token_for_business",function(dataResponse)
{if(dataResponse.birthday)
{var res=dataResponse.birthday.split('/');var date=new Date(res[2]+'-'+ res[0]+'-'+ res[1]);}
MCSDK["analytics"]["sendEvent"]('client_init',{"dob":date,"facebook_id":dataResponse.id,"facebook_id_for_business":dataResponse.token_for_business,"gender":dataResponse.gender,"os":MCSDK["analytics"]["os_info"],"browser":MCSDK["analytics"]["browser_info"],"timestamp":+new Date()});});}
function fetchFacebookPermissions(){window['FB']['api']("/me/permissions",function(response){if(response&&response.data){storageInfo["permissions"]=response.data;}});}
function getFacebookPermissions(){return storageInfo["permissions"];}
function checkFacebookPermissions(permissions){var fbPermissionsFunc=window['getFacebookPermissions'];if(fbPermissionsFunc){var fbPermissions=fbPermissionsFunc();var permissionsList=permissions.split(",");if(fbPermissions==null)
return false;for(var k=0;k<permissionsList.length;k++){var found=false;for(var i=0;i<fbPermissions.length;i++){if(permissionsList[k]==fbPermissions[i].permission&&fbPermissions[i].status=="granted")
found=true;}
if(!found){return false;}}
return true;}
else{return false;}}
function requestExtraPermissions(new_permissions){var granted=window['checkFacebookPermissions'](new_permissions);if(!granted){if(fbScope.indexOf(new_permissions)==-1){fbScope+=','+ new_permissions;}
window['facebookRelogin']();}
return!granted;}
window['getFacebookPermissions']=getFacebookPermissions;window['fetchFacebookPermissions']=fetchFacebookPermissions;window['requestExtraPermissions']=requestExtraPermissions;window['checkFacebookPermissions']=checkFacebookPermissions;window['fbAsyncInit']=fbAsyncInit;var gplusConnected=false;var gplusUser=null;var google_=(function(exports){var events={};var gapiLoaded=false;var loadGoogleServices=function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//apis.google.com/js/client:platform.js?onload=gapiAsyncInit";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)
gapiLoaded=true;}
window['gapiAsyncInit']=function(){$(events).trigger("initialized");};exports.google={loadServices:function(){loadGoogleServices();},getMeProfile:function(token,callback){window.gapi.client.load('plus','v1',function(){var request=gapi.client.plus.people.get({'userId':'me'});request.execute(function(resp){callback(resp);});});}};exports.onGoogleInit=function(callback){if(!gapiLoaded){loadGoogleServices();}
if(typeof gapi!=="undefined"){callback();}else{$(events).bind("initialized",callback);}}
return exports;})(agarApp);var gplusModule=(function(exports){var gplusLoaded=false;var gplusLoginChecked=false;var auth2=null;var authorizeOpts={"client_id":EnvConfig["gplus_client_id"],"cookie_policy":"single_host_origin","scope":"https://www.googleapis.com/auth/plus.login email","app_package_name":"com.miniclip.agar.io"};var loadProfilePicture=function(avatar){storageInfo["userInfo"]["picture"]=avatar;$('.agario-profile-picture')['attr']('src',avatar);}
var handleUserProfile=function(profile){if(profile){loadProfilePicture(profile.image.url);}}
var validateUserToken=function(token){window['MC']['doLoginWithGPlus'](token);agarApp.cache['login_info']=[token,'google'];window['MC']['showInstructionsPanel'](true);}
exports.gplus={userAuth:function(){return auth2;},shouldCheckLogin:function()
{return(storageInfo&&storageInfo['loginIntent']=='1'&&storageInfo['context']=='google');},init:function(){var self=this;agarApp.onGoogleInit(function(){window.gapi.ytsubscribe.go('agarYoutube');gplusLoaded=true;self.checkGPlusLogin();});},checkGPlusLogin:function(){if(gplusLoginChecked==true||hasInitialized==false||gplusLoaded==false)return;gplusLoginChecked=true;var self=this;window.gapi.load('auth2',function(){auth2=window.gapi.auth2.init(authorizeOpts);var element=document.getElementById('gplusLogin');element.addEventListener("click",function(){storageInfo["context"]="google";storageInfo['loginIntent']='1';window['MC']['googleLogin']();self.onAuthPopupOpen(window.open,auth2);});auth2['attachClickHandler'](element,{},function(googleUser){},self.onAuthError);auth2['currentUser']['listen'](_.bind(self.onChangeUser,self));auth2['then'](_.bind(self.onAuthInitComplete,self),_.bind(self.onAuthError,self));})},onAuthPopupOpen:function(wrapped,auth2){var self=this;var authorizeDeferred=auth2.authorize;window.open=function(){window.open=wrapped;var win=wrapped.apply(this,arguments);var i=setInterval(function(){if(win.closed){clearInterval(i);window['MC']['onGoogleLoginComplete'](false);}},100);return win;};},onAuthInitComplete:function(authResult)
{var currentUser=auth2['currentUser']['get']();if(!this.shouldCheckLogin())return;if(!auth2['isSignedIn']['get']()){auth2['signIn']();}},onAuthError:function(error)
{},onChangeUser:function(user){var self=this;if(auth2==null||user==null)return;if(!this.shouldCheckLogin())return;var isSignedIn=auth2['isSignedIn']['get']();gplusSendAnalyticsEvent(auth2);if(isSignedIn&&!gplusConnected){gplusConnected=true;var authResponse=user['getAuthResponse']();var access_token=authResponse['access_token'];var profile=user['getBasicProfile']();var imageUrl=profile['getImageUrl']();if(imageUrl==undefined){agarApp.google.getMeProfile(authResponse,function(plusProfile){if(!plusProfile['result']['isPlusUser']){alert('Please add Google+ to your Google account and try again.\nOr you can login with another account.');window["logout"]();return}
handleUserProfile(plusProfile);validateUserToken(access_token);if(plusProfile){storageInfo['userInfo']['picture']=plusProfile['image']['url'];}
storageInfo['userInfo']['socialId']=profile['getId']();updateLoggedUserInfo();});}else{loadProfilePicture(imageUrl);storageInfo['userInfo']['picture']=imageUrl;storageInfo['userInfo']['socialId']=profile['getId']();updateLoggedUserInfo();validateUserToken(access_token);}
window["updateStorage"]();}
window['MC']['onGoogleLoginComplete'](true);},logout:function(){if(!auth2)return;auth2['signOut']();gplusConnected=false;}}
return exports;})(agarApp);window['gplusModule']=gplusModule;function gplusSendAnalyticsEvent(auth2)
{agarApp.google.getMeProfile(auth2,function(plusProfile)
{MCSDK["analytics"]["sendEvent"]('client_init',{"dob":plusProfile.birthday,"gender":plusProfile.gender,"google_plus_id":plusProfile.id,"os":MCSDK["analytics"]["os_info"],"browser":MCSDK["analytics"]["browser_info"],"timestamp":+new Date()});});}
var logoutGooglePlus=function(){agarApp.gplus.logout();}
window['logoutGooglePlus']=logoutGooglePlus;function getStatsString(originalStr){var timeAlive=$('.stats-time-alive').text();var minsAlive=timeAlive.split(':')[0];var secsAlive=timeAlive.split(':')[1];return window["parseString"](originalStr,'%@',[minsAlive,secsAlive,$('.stats-highest-mass').text()]);}
window['getStatsString']=getStatsString;function fbShare(name,caption,description,link,picture,action_name,action_link,opt_callback){link+="?title="+ encodeURIComponent(name)+"&description="+ encodeURIComponent(description)+"&image="+ encodeURIComponent(picture);var fbCallbackShare=opt_callback;var shareOptions={method:'feed',display:'iframe',caption:caption,link:link};if(fbCallbackShare!=null){window['FB']['ui'](shareOptions,fbCallbackShare);}else{window['FB']['ui'](shareOptions);}}
function twitterShare(description){var params="text="+ description;var targetUrl="https://twitter.com/intent/tweet?"+ params;var width=660;var height=310;var windowOptions='width='+ width+',height='+ height+',menubar=no,toolbar=no,resizable=yes,scrollbars=no';window.open(targetUrl,'Agar.io',windowOptions+',left='+
((window.screenX+ window.innerWidth/2)- width/2)+",top="+(window.innerHeight- height)/ 2);
}
window['twitterShareStats']=function(){twitterShare(window['getStatsString']('page_tt_share_stats'));}
window['fbShareStats']=function(){fbShare(window["i18n"]('page_fb_matchresults_title'),window["i18n"]('page_fb_matchresults_description'),window['getStatsString']('page_fb_matchresults_subtitle'),'https://r.agar.io','http://static2.miniclipcdn.com/mobile/agar/Agar.io_matchresults_fb_1200x630.png','play now!','https://r.agar.io');}
window['fillSocialValues']=function(value,target){if(window['storageInfo']['context']=='google'){var options={'contenturl':EnvConfig['game_url'],'clientid':EnvConfig["gplus_client_id"],'cookiepolicy':'http://agar.io','prefilltext':value,'calltoactionlabel':'BEAT','calltoactionurl':EnvConfig['game_url']};if(window['isChrome']==true){window['gapi']['interactivepost']['render'](target,options);}else{document.getElementById(target).click=function(e){window.open('https://plus.google.com/share?url='+ EnvConfig['game_url']+'&text='+ value,'','menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=400');}}}}
$(function(){window.showConsoleLogo();if("MAsyncInit"in window){window['MAsyncInit']();}
$('[data-itr]').each(function(){var $this=$(this);var itr=$this.attr('data-itr');$this.html(window["i18n"](itr));});});})(window,window['jQuery']);